# Environment Setup Guide

## Quick Setup

### Option 1: Using the Script (Recommended)

**For Windows:**
```bash
.\create-env-files.bat
```

**For Linux/Mac:**
```bash
chmod +x create-env-files.sh
./create-env-files.sh
```

### Option 2: Manual Setup

#### Backend (.env)

Create `backend/.env` file with the following content:

```env
APP_NAME=CRM
APP_ENV=local
APP_KEY=
APP_DEBUG=true
APP_TIMEZONE=UTC
APP_URL=http://localhost:8000

APP_LOCALE=en
APP_FALLBACK_LOCALE=en
APP_FAKER_LOCALE=en_US

APP_MAINTENANCE_DRIVER=file

PHP_CLI_SERVER_WORKERS=4

BCRYPT_ROUNDS=12

LOG_CHANNEL=stack
LOG_STACK=single
LOG_DEPRECATIONS_CHANNEL=null
LOG_LEVEL=debug

DB_CONNECTION=mysql
DB_HOST=db
DB_PORT=3306
DB_DATABASE=crm
DB_USERNAME=crm_user
DB_PASSWORD=password

SESSION_DRIVER=redis
SESSION_LIFETIME=120
SESSION_ENCRYPT=false
SESSION_PATH=/
SESSION_DOMAIN=null

BROADCAST_CONNECTION=log
FILESYSTEM_DISK=local
QUEUE_CONNECTION=database

CACHE_STORE=redis

MEMCACHED_HOST=127.0.0.1

REDIS_CLIENT=phpredis
REDIS_HOST=redis
REDIS_PASSWORD=null
REDIS_PORT=6379

MAIL_MAILER=log
MAIL_SCHEME=null
MAIL_HOST=127.0.0.1
MAIL_PORT=2525
MAIL_USERNAME=null
MAIL_PASSWORD=null
MAIL_FROM_ADDRESS="hello@example.com"
MAIL_FROM_NAME="${APP_NAME}"

AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=
AWS_USE_PATH_STYLE_ENDPOINT=false

VITE_APP_NAME="${APP_NAME}"
VITE_APP_URL=http://localhost:5173
```

#### Frontend (.env.local)

Create `frontend/.env.local` file with the following content:

```env
# API Configuration
NEXT_PUBLIC_API_URL=http://localhost:8000/api

# Environment
NODE_ENV=development

# Telemetry
NEXT_TELEMETRY_DISABLED=1
```

## Post-Setup Steps

### 1. Generate Laravel Application Key

After creating the backend `.env` file, generate the application key:

```bash
cd backend
php artisan key:generate
```

This will automatically update the `APP_KEY` in your `.env` file.

### 2. Install Dependencies

**Backend:**
```bash
cd backend
composer install
```

**Frontend:**
```bash
cd frontend
npm install
```

### 3. Run Migrations (if using Docker)

```bash
docker compose up -d
docker compose exec app php artisan migrate --seed
```

## Environment Variables Explained

### Backend

- **APP_KEY**: Laravel encryption key (auto-generated by `php artisan key:generate`)
- **DB_HOST**: Set to `db` for Docker, or `127.0.0.1` for local development
- **REDIS_HOST**: Set to `redis` for Docker, or `127.0.0.1` for local development
- **APP_URL**: Your backend URL (default: http://localhost:8000)
- **VITE_APP_URL**: Frontend dev server URL (default: http://localhost:5173)

### Frontend

- **NEXT_PUBLIC_API_URL**: Backend API endpoint (must start with `NEXT_PUBLIC_` to be accessible in browser)
- **NODE_ENV**: Set to `development` for local dev, `production` for builds

## Docker vs Local Development

### Using Docker (Recommended)
The environment variables in `.env` files are already configured for Docker. Just run:
```bash
docker compose up -d
```

### Local Development
If running without Docker, update these variables:
- `DB_HOST=127.0.0.1` (instead of `db`)
- `REDIS_HOST=127.0.0.1` (instead of `redis`)
- Make sure MySQL and Redis are running locally
